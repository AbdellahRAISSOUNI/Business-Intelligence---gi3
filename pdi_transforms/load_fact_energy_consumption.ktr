<?xml version="1.0" encoding="UTF-8"?>
<transformation>
  <info>
    <name>load_fact_energy_consumption</name>
    <description>Load fact_energy_consumption from staging CSVs via temp table</description>
    <extended_description/>
    <trans_version/>
    <trans_type>Normal</trans_type>
    <directory>/</directory>
    <parameters/>
    <log>
      <trans-log-table>
        <connection/>
        <schema/>
        <table/>
        <field><id>ID_BATCH</id><enabled>Y</enabled><name>ID_BATCH</name></field>
        <field><id>CHANNEL_ID</id><enabled>Y</enabled><name>CHANNEL_ID</name></field>
        <field><id>TRANSNAME</id><enabled>Y</enabled><name>TRANSNAME</name></field>
        <field><id>STATUS</id><enabled>Y</enabled><name>STATUS</name></field>
        <field><id>LINES_READ</id><enabled>Y</enabled><name>LINES_READ</name><subject/></field>
        <field><id>LINES_WRITTEN</id><enabled>Y</enabled><name>LINES_WRITTEN</name><subject/></field>
        <field><id>LINES_UPDATED</id><enabled>Y</enabled><name>LINES_UPDATED</name><subject/></field>
        <field><id>LINES_INPUT</id><enabled>Y</enabled><name>LINES_INPUT</name><subject/></field>
        <field><id>LINES_OUTPUT</id><enabled>Y</enabled><name>LINES_OUTPUT</name><subject/></field>
        <field><id>LINES_REJECTED</id><enabled>Y</enabled><name>LINES_REJECTED</name><subject/></field>
        <field><id>ERRORS</id><enabled>Y</enabled><name>ERRORS</name></field>
        <field><id>STARTDATE</id><enabled>Y</enabled><name>STARTDATE</name></field>
        <field><id>ENDDATE</id><enabled>Y</enabled><name>ENDDATE</name></field>
        <field><id>LOGDATE</id><enabled>Y</enabled><name>LOGDATE</name></field>
        <field><id>DEPDATE</id><enabled>Y</enabled><name>DEPDATE</name></field>
        <field><id>REPLAYDATE</id><enabled>Y</enabled><name>REPLAYDATE</name></field>
        <field><id>LOG_FIELD</id><enabled>Y</enabled><name>LOG_FIELD</name></field>
        <field><id>EXECUTING_SERVER</id><enabled>N</enabled><name>EXECUTING_SERVER</name></field>
        <field><id>EXECUTING_USER</id><enabled>N</enabled><name>EXECUTING_USER</name></field>
        <field><id>CLIENT</id><enabled>N</enabled><name>CLIENT</name></field>
        <size_limit_lines/>
        <interval/>
        <timeout_days/>
      </trans-log-table>
    </log>
    <maxdate>
      <connection/>
      <table/>
      <field/>
      <offset>0.0</offset>
      <maxdiff>0.0</maxdiff>
    </maxdate>
    <size_rowset>10000</size_rowset>
    <sleep_time_empty>50</sleep_time_empty>
    <sleep_time_full>50</sleep_time_full>
    <unique_connections>N</unique_connections>
    <feedback_shown>Y</feedback_shown>
    <feedback_size>50000</feedback_size>
    <using_thread_priorities>Y</using_thread_priorities>
    <shared_objects_file/>
    <capture_step_performance>N</capture_step_performance>
    <step_performance_capturing_delay>1000</step_performance_capturing_delay>
    <step_performance_capturing_size_limit>100</step_performance_capturing_size_limit>
    <dependencies/>
    <partitionschemas/>
    <slaveservers/>
    <clusterschemas/>
    <created_user>-</created_user>
    <created_date>2025/12/23 18:45:00.000</created_date>
    <modified_user>-</modified_user>
    <modified_date>2025/12/23 18:50:00.000</modified_date>
    <key_for_session_key/>
    <is_key_private>N</is_key_private>
  </info>

  <connection>
    <name>dm_mysql</name>
    <server>localhost</server>
    <type>MYSQL</type>
    <access>Native</access>
    <database>greencity_dm</database>
    <port>3306</port>
    <username>root</username>
    <password></password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes/>
  </connection>

  <notepads/>

  <order>
    <hop>
      <from>Clear temp table</from>
      <to>Read electricite CSV</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Clear temp table</from>
      <to>Read eau CSV</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Clear temp table</from>
      <to>Read gaz CSV</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Read electricite CSV</from>
      <to>Add energy type electricite</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Add energy type electricite</from>
      <to>Parse date electricite</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Parse date electricite</from>
      <to>Load electricite to temp</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Read eau CSV</from>
      <to>Add energy type eau</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Add energy type eau</from>
      <to>Parse date eau</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Parse date eau</from>
      <to>Load eau to temp</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Read gaz CSV</from>
      <to>Add energy type gaz</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Add energy type gaz</from>
      <to>Parse date gaz</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Parse date gaz</from>
      <to>Load gaz to temp</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Load electricite to temp</from>
      <to>Execute fact insert SQL</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Load eau to temp</from>
      <to>Execute fact insert SQL</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Load gaz to temp</from>
      <to>Execute fact insert SQL</to>
      <enabled>Y</enabled>
    </hop>
  </order>

  <step>
    <name>Clear temp table</name>
    <type>ExecSQL</type>
    <description>Truncate temp_consumption table</description>
    <distribute>Y</distribute>
    <copies>1</copies>
    <partitioning><method>none</method><schema_name/></partitioning>
    <connection>dm_mysql</connection>
    <sql>TRUNCATE TABLE temp_consumption</sql>
    <executed_each_row>N</executed_each_row>
    <single_statement>Y</single_statement>
    <replace_variables>N</replace_variables>
    <quote_string>N</quote_string>
    <set_params>N</set_params>
    <insert_field>insert_field</insert_field>
    <update_field>update_field</update_field>
    <delete_field>delete_field</delete_field>
    <read_field>read_field</read_field>
    <cluster_schema/>
    <remotesteps><input/><output/></remotesteps>
    <GUI><xloc>128</xloc><yloc>128</yloc><draw>Y</draw></GUI>
  </step>

  <step>
    <name>Read electricite CSV</name>
    <type>TextFileInput</type>
    <description>Read electricity consumption CSV</description>
    <distribute>Y</distribute>
    <copies>1</copies>
    <partitioning><method>none</method><schema_name/></partitioning>
    <file>
      <name>C:/Users/earth/Desktop/s9/bi/Business Intelligence - Mini Projet/staging/consumption_electricite.csv</name>
      <filemask/>
      <exclude_filemask/>
      <file_required>N</file_required>
      <include_subfolders>N</include_subfolders>
    </file>
    <filter>
      <filter><filterString/><filterPosition>0</filterPosition><filterPositive>Y</filterPositive><filterTokenType>0</filterTokenType><filterLastLine>N</filterLastLine></filter>
    </filter>
    <content>
      <separator>,</separator>
      <enclosure>"</enclosure>
      <enclosure_breaks>N</enclosure_breaks>
      <escapechar/>
      <header>Y</header>
      <nr_header_lines>1</nr_header_lines>
      <footer>N</footer>
      <nr_footer_lines>0</nr_footer_lines>
      <line_wrapped>N</line_wrapped>
      <nr_wraps>0</nr_wraps>
      <layout>fields</layout>
      <fileFormat>unix</fileFormat>
      <encoding>UTF-8</encoding>
      <add_filename_result>N</add_filename_result>
      <resetRowNumber>N</resetRowNumber>
      <parallel>N</parallel>
      <no_empty_lines>N</no_empty_lines>
      <include_filename>N</include_filename>
      <include_row_number>N</include_row_number>
      <row_number_field/>
      <file_name_field/>
      <file_size_field/>
    </content>
    <fields>
      <field>
        <name>compteur_id</name>
        <type>String</type>
        <format/>
        <currency/>
        <decimal/>
        <group/>
        <trim_type>none</trim_type>
        <repeat>N</repeat>
        <length>-1</length>
        <precision>-1</precision>
      </field>
      <field>
        <name>date_mesure</name>
        <type>String</type>
        <format/>
        <currency/>
        <decimal/>
        <group/>
        <trim_type>none</trim_type>
        <repeat>N</repeat>
        <length>-1</length>
        <precision>-1</precision>
      </field>
      <field>
        <name>consommation</name>
        <type>Number</type>
        <format/>
        <currency/>
        <decimal/>
        <group/>
        <trim_type>none</trim_type>
        <repeat>N</repeat>
        <length>-1</length>
        <precision>-1</precision>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps><input/><output/></remotesteps>
    <GUI><xloc>352</xloc><yloc>64</yloc><draw>Y</draw></GUI>
  </step>

  <step>
    <name>Add energy type electricite</name>
    <type>Constant</type>
    <description>Add energy_type field</description>
    <distribute>Y</distribute>
    <copies>1</copies>
    <partitioning><method>none</method><schema_name/></partitioning>
    <fields>
      <field>
        <name>energy_type</name>
        <type>String</type>
        <format/>
        <currency/>
        <decimal/>
        <group/>
        <value>electricite</value>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps><input/><output/></remotesteps>
    <GUI><xloc>576</xloc><yloc>64</yloc><draw>Y</draw></GUI>
  </step>

  <step>
    <name>Parse date electricite</name>
    <type>Calculator</type>
    <description>Parse date_mesure string to Date</description>
    <distribute>Y</distribute>
    <copies>1</copies>
    <partitioning><method>none</method><schema_name/></partitioning>
    <fields>
      <field>
        <name>measure_date</name>
        <rename>measure_date</rename>
        <type>Date</type>
        <value_type>0</value_type>
        <value>date_mesure</value>
        <mask>yyyy-MM-dd'T'HH:mm:ss</mask>
        <currency/>
        <decimal/>
        <group/>
        <length>-1</length>
        <precision>-1</precision>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps><input/><output/></remotesteps>
    <GUI><xloc>800</xloc><yloc>64</yloc><draw>Y</draw></GUI>
  </step>

  <step>
    <name>Load electricite to temp</name>
    <type>TableOutput</type>
    <description>Load electricity data into temp_consumption</description>
    <distribute>Y</distribute>
    <copies>1</copies>
    <partitioning><method>none</method><schema_name/></partitioning>
    <connection>dm_mysql</connection>
    <schema/>
    <table>temp_consumption</table>
    <commit>1000</commit>
    <truncate_table>N</truncate_table>
    <ignore_errors>N</ignore_errors>
    <use_batch>Y</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field/>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>N</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>N</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
      <field>
        <column_name>compteur_id</column_name>
        <stream_name>compteur_id</stream_name>
      </field>
      <field>
        <column_name>date_mesure</column_name>
        <stream_name>measure_date</stream_name>
      </field>
      <field>
        <column_name>consommation</column_name>
        <stream_name>consommation</stream_name>
      </field>
      <field>
        <column_name>energy_type</column_name>
        <stream_name>energy_type</stream_name>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps><input/><output/></remotesteps>
    <GUI><xloc>1024</xloc><yloc>64</yloc><draw>Y</draw></GUI>
  </step>

  <step>
    <name>Read eau CSV</name>
    <type>TextFileInput</type>
    <description>Read water consumption CSV</description>
    <distribute>Y</distribute>
    <copies>1</copies>
    <partitioning><method>none</method><schema_name/></partitioning>
    <file>
      <name>C:/Users/earth/Desktop/s9/bi/Business Intelligence - Mini Projet/staging/consumption_eau.csv</name>
      <filemask/>
      <exclude_filemask/>
      <file_required>N</file_required>
      <include_subfolders>N</include_subfolders>
    </file>
    <filter>
      <filter><filterString/><filterPosition>0</filterPosition><filterPositive>Y</filterPositive><filterTokenType>0</filterTokenType><filterLastLine>N</filterLastLine></filter>
    </filter>
    <content>
      <separator>,</separator>
      <enclosure>"</enclosure>
      <enclosure_breaks>N</enclosure_breaks>
      <escapechar/>
      <header>Y</header>
      <nr_header_lines>1</nr_header_lines>
      <footer>N</footer>
      <nr_footer_lines>0</nr_footer_lines>
      <line_wrapped>N</line_wrapped>
      <nr_wraps>0</nr_wraps>
      <layout>fields</layout>
      <fileFormat>unix</fileFormat>
      <encoding>UTF-8</encoding>
      <add_filename_result>N</add_filename_result>
      <resetRowNumber>N</resetRowNumber>
      <parallel>N</parallel>
      <no_empty_lines>N</no_empty_lines>
      <include_filename>N</include_filename>
      <include_row_number>N</include_row_number>
      <row_number_field/>
      <file_name_field/>
      <file_size_field/>
    </content>
    <fields>
      <field>
        <name>compteur_id</name>
        <type>String</type>
        <format/>
        <currency/>
        <decimal/>
        <group/>
        <trim_type>none</trim_type>
        <repeat>N</repeat>
        <length>-1</length>
        <precision>-1</precision>
      </field>
      <field>
        <name>date_mesure</name>
        <type>String</type>
        <format/>
        <currency/>
        <decimal/>
        <group/>
        <trim_type>none</trim_type>
        <repeat>N</repeat>
        <length>-1</length>
        <precision>-1</precision>
      </field>
      <field>
        <name>consommation</name>
        <type>Number</type>
        <format/>
        <currency/>
        <decimal/>
        <group/>
        <trim_type>none</trim_type>
        <repeat>N</repeat>
        <length>-1</length>
        <precision>-1</precision>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps><input/><output/></remotesteps>
    <GUI><xloc>352</xloc><yloc>128</yloc><draw>Y</draw></GUI>
  </step>

  <step>
    <name>Add energy type eau</name>
    <type>Constant</type>
    <description>Add energy_type field</description>
    <distribute>Y</distribute>
    <copies>1</copies>
    <partitioning><method>none</method><schema_name/></partitioning>
    <fields>
      <field>
        <name>energy_type</name>
        <type>String</type>
        <format/>
        <currency/>
        <decimal/>
        <group/>
        <value>eau</value>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps><input/><output/></remotesteps>
    <GUI><xloc>576</xloc><yloc>128</yloc><draw>Y</draw></GUI>
  </step>

  <step>
    <name>Parse date eau</name>
    <type>Calculator</type>
    <description>Parse date_mesure string to Date</description>
    <distribute>Y</distribute>
    <copies>1</copies>
    <partitioning><method>none</method><schema_name/></partitioning>
    <fields>
      <field>
        <name>measure_date</name>
        <rename>measure_date</rename>
        <type>Date</type>
        <value_type>0</value_type>
        <value>date_mesure</value>
        <mask>yyyy-MM-dd'T'HH:mm:ss</mask>
        <currency/>
        <decimal/>
        <group/>
        <length>-1</length>
        <precision>-1</precision>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps><input/><output/></remotesteps>
    <GUI><xloc>800</xloc><yloc>128</yloc><draw>Y</draw></GUI>
  </step>

  <step>
    <name>Load eau to temp</name>
    <type>TableOutput</type>
    <description>Load water data into temp_consumption</description>
    <distribute>Y</distribute>
    <copies>1</copies>
    <partitioning><method>none</method><schema_name/></partitioning>
    <connection>dm_mysql</connection>
    <schema/>
    <table>temp_consumption</table>
    <commit>1000</commit>
    <truncate_table>N</truncate_table>
    <ignore_errors>N</ignore_errors>
    <use_batch>Y</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field/>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>N</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>N</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
      <field>
        <column_name>compteur_id</column_name>
        <stream_name>compteur_id</stream_name>
      </field>
      <field>
        <column_name>date_mesure</column_name>
        <stream_name>measure_date</stream_name>
      </field>
      <field>
        <column_name>consommation</column_name>
        <stream_name>consommation</stream_name>
      </field>
      <field>
        <column_name>energy_type</column_name>
        <stream_name>energy_type</stream_name>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps><input/><output/></remotesteps>
    <GUI><xloc>1024</xloc><yloc>128</yloc><draw>Y</draw></GUI>
  </step>

  <step>
    <name>Read gaz CSV</name>
    <type>TextFileInput</type>
    <description>Read gas consumption CSV</description>
    <distribute>Y</distribute>
    <copies>1</copies>
    <partitioning><method>none</method><schema_name/></partitioning>
    <file>
      <name>C:/Users/earth/Desktop/s9/bi/Business Intelligence - Mini Projet/staging/consumption_gaz.csv</name>
      <filemask/>
      <exclude_filemask/>
      <file_required>N</file_required>
      <include_subfolders>N</include_subfolders>
    </file>
    <filter>
      <filter><filterString/><filterPosition>0</filterPosition><filterPositive>Y</filterPositive><filterTokenType>0</filterTokenType><filterLastLine>N</filterLastLine></filter>
    </filter>
    <content>
      <separator>,</separator>
      <enclosure>"</enclosure>
      <enclosure_breaks>N</enclosure_breaks>
      <escapechar/>
      <header>Y</header>
      <nr_header_lines>1</nr_header_lines>
      <footer>N</footer>
      <nr_footer_lines>0</nr_footer_lines>
      <line_wrapped>N</line_wrapped>
      <nr_wraps>0</nr_wraps>
      <layout>fields</layout>
      <fileFormat>unix</fileFormat>
      <encoding>UTF-8</encoding>
      <add_filename_result>N</add_filename_result>
      <resetRowNumber>N</resetRowNumber>
      <parallel>N</parallel>
      <no_empty_lines>N</no_empty_lines>
      <include_filename>N</include_filename>
      <include_row_number>N</include_row_number>
      <row_number_field/>
      <file_name_field/>
      <file_size_field/>
    </content>
    <fields>
      <field>
        <name>compteur_id</name>
        <type>String</type>
        <format/>
        <currency/>
        <decimal/>
        <group/>
        <trim_type>none</trim_type>
        <repeat>N</repeat>
        <length>-1</length>
        <precision>-1</precision>
      </field>
      <field>
        <name>date_mesure</name>
        <type>String</type>
        <format/>
        <currency/>
        <decimal/>
        <group/>
        <trim_type>none</trim_type>
        <repeat>N</repeat>
        <length>-1</length>
        <precision>-1</precision>
      </field>
      <field>
        <name>consommation</name>
        <type>Number</type>
        <format/>
        <currency/>
        <decimal/>
        <group/>
        <trim_type>none</trim_type>
        <repeat>N</repeat>
        <length>-1</length>
        <precision>-1</precision>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps><input/><output/></remotesteps>
    <GUI><xloc>352</xloc><yloc>192</yloc><draw>Y</draw></GUI>
  </step>

  <step>
    <name>Add energy type gaz</name>
    <type>Constant</type>
    <description>Add energy_type field</description>
    <distribute>Y</distribute>
    <copies>1</copies>
    <partitioning><method>none</method><schema_name/></partitioning>
    <fields>
      <field>
        <name>energy_type</name>
        <type>String</type>
        <format/>
        <currency/>
        <decimal/>
        <group/>
        <value>gaz</value>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps><input/><output/></remotesteps>
    <GUI><xloc>576</xloc><yloc>192</yloc><draw>Y</draw></GUI>
  </step>

  <step>
    <name>Parse date gaz</name>
    <type>Calculator</type>
    <description>Parse date_mesure string to Date</description>
    <distribute>Y</distribute>
    <copies>1</copies>
    <partitioning><method>none</method><schema_name/></partitioning>
    <fields>
      <field>
        <name>measure_date</name>
        <rename>measure_date</rename>
        <type>Date</type>
        <value_type>0</value_type>
        <value>date_mesure</value>
        <mask>yyyy-MM-dd'T'HH:mm:ss</mask>
        <currency/>
        <decimal/>
        <group/>
        <length>-1</length>
        <precision>-1</precision>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps><input/><output/></remotesteps>
    <GUI><xloc>800</xloc><yloc>192</yloc><draw>Y</draw></GUI>
  </step>

  <step>
    <name>Load gaz to temp</name>
    <type>TableOutput</type>
    <description>Load gas data into temp_consumption</description>
    <distribute>Y</distribute>
    <copies>1</copies>
    <partitioning><method>none</method><schema_name/></partitioning>
    <connection>dm_mysql</connection>
    <schema/>
    <table>temp_consumption</table>
    <commit>1000</commit>
    <truncate_table>N</truncate_table>
    <ignore_errors>N</ignore_errors>
    <use_batch>Y</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field/>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>N</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>N</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
      <field>
        <column_name>compteur_id</column_name>
        <stream_name>compteur_id</stream_name>
      </field>
      <field>
        <column_name>date_mesure</column_name>
        <stream_name>measure_date</stream_name>
      </field>
      <field>
        <column_name>consommation</column_name>
        <stream_name>consommation</stream_name>
      </field>
      <field>
        <column_name>energy_type</column_name>
        <stream_name>energy_type</stream_name>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps><input/><output/></remotesteps>
    <GUI><xloc>1024</xloc><yloc>192</yloc><draw>Y</draw></GUI>
  </step>

  <step>
    <name>Execute fact insert SQL</name>
    <type>ExecSQL</type>
    <description>Insert into fact_energy_consumption from temp table with dimension lookups</description>
    <distribute>Y</distribute>
    <copies>1</copies>
    <partitioning><method>none</method><schema_name/></partitioning>
    <connection>dm_mysql</connection>
    <sql>INSERT INTO fact_energy_consumption (date_key, meter_key, building_key, client_key, region_key, energy_type_key, consumption_value, consumption_kwh) SELECT dd.date_key, dm.meter_key, db.building_key, db.client_key, db.region_key, dm.energy_type_key, tc.consommation AS consumption_value, CASE WHEN det.energy_type_code = 'electricite' THEN tc.consommation ELSE NULL END AS consumption_kwh FROM temp_consumption tc INNER JOIN dim_meter dm ON tc.compteur_id = dm.meter_id INNER JOIN dim_energy_type det ON dm.energy_type_key = det.energy_type_key AND det.energy_type_code = tc.energy_type INNER JOIN dim_building db ON dm.building_key = db.building_key INNER JOIN dim_date dd ON DATE(tc.date_mesure) = dd.full_date</sql>
    <executed_each_row>N</executed_each_row>
    <single_statement>Y</single_statement>
    <replace_variables>N</replace_variables>
    <quote_string>N</quote_string>
    <set_params>N</set_params>
    <insert_field>insert_field</insert_field>
    <update_field>update_field</update_field>
    <delete_field>delete_field</delete_field>
    <read_field>read_field</read_field>
    <cluster_schema/>
    <remotesteps><input/><output/></remotesteps>
    <GUI><xloc>1248</xloc><yloc>128</yloc><draw>Y</draw></GUI>
  </step>

  <step_error_handling/>
  <slave-step-copy-partition-distribution/>
  <slave_transformation>N</slave_transformation>
  <attributes/>
</transformation>
